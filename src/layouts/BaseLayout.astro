---
import Menu from '../components/Menu.astro';

const {
  title = 'Food Reviews',
  description = 'Personal food review blog',
  currentPath = '/'
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta name="theme-color" content="#191724" />
    <style>
      :root{
        /* Base palette */
        --base: #191724;        /* rgb(25,23,36) */
        --surface: #1f1d2e;     /* rgb(31,29,46) */
        --overlay: #26233a;     /* rgb(38,35,58) */
        --muted: #6e6a86;       /* rgb(110,106,134) */
        --subtle: #908caa;      /* rgb(144,140,170) */
        --text: #e0def4;        /* rgb(224,222,244) */
        --love: #eb6f92;        /* pink accent */
        --gold: #f6c177;        /* primary accent (default) */
        --rose: #ebbcba;
        --pine: #31748f;
        --foam: #9ccfd8;
        --iris: #c4a7e7;
        --hl-low: #21202e;
        --hl-med: #403d52;
        --hl-high: #524f67;

        /* Semantic tokens */
        --background: var(--base);
        --surface-1: var(--surface);
        --surface-2: var(--overlay);
        --text-primary: var(--text);
        --text-muted: var(--muted);
        --border: var(--hl-med);
        --accent: var(--love);
        --accent-strong: var(--love);
        --hover: color-mix(in srgb, var(--accent) 10%, transparent);
        --highlight: color-mix(in srgb, var(--iris) 20%, transparent);

        --shadow-elev-1: 0 8px 30px rgba(2,6,23,0.45);
        --surface-glass: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.14));
        --surface-card: linear-gradient(180deg, rgba(255,255,255,0.01), var(--surface-1));
        --surface-active: linear-gradient(180deg, color-mix(in srgb, var(--accent) 18%, transparent), color-mix(in srgb, var(--accent) 8%, transparent));

        --focus-ring: color-mix(in srgb, var(--iris) 18%, transparent);
        --selection-bg: color-mix(in srgb, var(--accent) 35%, transparent);
        --selection-text: var(--text-primary);

        /* Backwards compatibility aliases */
        --bg: var(--background);
        --card: var(--surface-1);
        --panel: var(--surface-2);
        --line: var(--border);
      }

      :root[data-theme='latte']{
        --base: #faf4ed;
        --surface: #fffaf4;
        --overlay: #f2e9e1;
        --text: #575279;
        --muted: #797593;
        --love: #b4637a;
        --iris: #907aa9;
        --hl-med: #dfdad9;
        --hl-high: #cecacd;
        --surface-glass: linear-gradient(180deg, rgba(87,82,121,0.03), rgba(87,82,121,0.01));
        --surface-card: linear-gradient(180deg, rgba(255,255,255,0.8), var(--surface-1));
        --shadow-elev-1: 0 8px 24px rgba(87,82,121,0.12);
      }

      :root[data-theme='amoled']{
        --base: #000000;
        --surface: #07070a;
        --overlay: #101015;
        --text: #f5f5f7;
        --muted: #9fa1ac;
        --love: #ff6fa9;
        --iris: #c8b2ff;
        --hl-med: #23232a;
        --hl-high: #30303a;
        --surface-glass: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
        --surface-card: linear-gradient(180deg, rgba(255,255,255,0.015), var(--surface-1));
        --shadow-elev-1: 0 8px 30px rgba(0,0,0,0.75);
      }

      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        background: linear-gradient(180deg, var(--background), var(--surface-1) 220px);
        color:var(--text-primary);
        -webkit-font-smoothing:antialiased;
        -moz-osx-font-smoothing:grayscale;
        line-height:1.45;
      }

      ::selection{
        background: var(--selection-bg);
        color: var(--selection-text);
      }

      /* page container */
      .container{
        width: min(1080px, 92vw);
        margin: 0 auto;
        padding: 1.1rem 0 2rem;
      }

      .muted{ color: var(--text-muted) }

      /* Tabs */
      .tabs{
        display:flex;
        gap:.5rem;
        overflow-x:auto;
        white-space:nowrap;
        scrollbar-width:thin;
        margin:.2rem 0 1.2rem;
        padding:.45rem;
        background: var(--surface-glass);
        border-radius:12px;
        border: 1px solid var(--line);
        backdrop-filter: blur(6px);
      }
      .tabs::-webkit-scrollbar{ height:8px }
      .tab{
        border: 1px solid var(--line);
        color: var(--text-primary);
        padding: .45rem .78rem;
        border-radius:9px;
        text-decoration:none;
        background: var(--card);
        display:inline-flex;
        align-items:center;
        gap:.5rem;
        font-weight:600;
        font-size:0.95rem;
      }
      .tab:hover{ transform: translateY(-1px); transition: transform .12s ease }
      .tab.active{
        border-color: var(--accent);
        box-shadow: 0 0 0 1px var(--accent) inset;
        background: var(--surface-active);
      }

      /* Grid & cards */
      .grid{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
        gap:1rem;
      }
      .card{
        border:1px solid var(--line);
        background: var(--surface-card);
        border-radius:14px;
        padding:.9rem;
        transition: box-shadow .12s ease, transform .12s ease;
      }
      .card:hover{
        transform: translateY(-6px);
        box-shadow: var(--shadow-elev-1);
      }

      /* Images */
      .thumb{
        width:100%;
        height:160px;
        object-fit:cover;
        border-radius:10px;
        border:1px solid var(--line);
      }
      .dish-image{
        width:100%;
        max-height:420px;
        object-fit:cover;
        border-radius:14px;
        border:1px solid var(--line);
      }

      /* Row helpers */
      .row{
        display:flex;
        gap:1rem;
        align-items:center;
        justify-content:space-between;
        flex-wrap:wrap;
      }

      .map{ margin-top:1rem }

      /* Code blocks */
      code,pre{
        background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(255,255,255,0.01));
        border:1px solid var(--line);
        padding:.12rem .3rem;
        border-radius:6px;
        color:var(--text-primary);
      }

      /* Leaflet map container */
      .leaflet-container{
        height:340px;
        border-radius:12px;
        border:1px solid var(--line);
        background: linear-gradient(180deg, color-mix(in srgb, var(--accent) 8%, transparent), color-mix(in srgb, var(--background) 80%, transparent));
      }

      /* Tiny responsive tweaks */
      @media (max-width:640px){
        .thumb{ height:140px }
        .container{ padding: .9rem 0 1.6rem }
        .tab{ padding:.35rem .6rem; font-size:.9rem }
      }

      /* Utility classes for badges, rating, etc. */
      .badge{
        display:inline-block;
        padding:.18rem .5rem;
        border-radius:999px;
        font-weight:700;
        font-size:.85rem;
        color:var(--background);
        background: linear-gradient(90deg,var(--accent),var(--accent-strong));
      }
      .rating{ color: var(--accent) }
      .meta{ color: var(--text-muted); font-size:0.93rem }

      /* focus outline for accessibility */
      a:focus, button:focus, input:focus, select:focus { outline: 3px solid var(--focus-ring); outline-offset: 3px; border-radius:8px; }

      /* ================= MOBILE OPTIMIZATION ================= */

      /* Tablet */
      @media (max-width: 768px){

        .container{
          width: 94vw;
          padding: .8rem 0 1.4rem;
        }

        /* improve reading width */
        main{
          font-size: 15.5px;
          line-height: 1.6;
        }

        /* tabs become swipe bar */
        .tabs{
          padding:.5rem;
          gap:.45rem;
          border-radius:14px;
          position:sticky;
          top:0;
          z-index:10;
          background:linear-gradient(180deg,var(--background),color-mix(in srgb, var(--background) 85%, transparent));
          backdrop-filter: blur(12px);
        }

        .tab{
          padding:.5rem .7rem;
          font-size:.92rem;
          border-radius:11px;
        }

        /* cards stack vertically */
        .grid{
          grid-template-columns:1fr;
          gap:.9rem;
        }

        .card{
          padding:.85rem;
        }

        /* images more phone friendly */
        .thumb{
          height:170px;
        }

        .dish-image{
          max-height:300px;
        }

        /* better spacing */
        h1,h2,h3{
          line-height:1.25;
          margin:.4rem 0 .6rem;
        }

        p{
          margin:.45rem 0;
        }
      }


      /* Small phones */
      @media (max-width: 480px){

        body{
          font-size:15px;
        }

        .container{
          width:96vw;
          padding:.7rem 0 1.1rem;
        }

        /* bigger tap targets */
        .tab{
          padding:.55rem .75rem;
          font-size:.9rem;
        }

        /* hero image shouldn't dominate screen */
        .dish-image{
          max-height:240px;
          border-radius:12px;
        }

        /* cards tighter but clearer */
        .card{
          border-radius:12px;
          padding:.75rem;
        }

        .thumb{
          height:150px;
        }

        /* map shouldn't feel infinite */
        .leaflet-container{
          height:260px;
        }

        /* rating + meta stacking */
        .row{
          flex-direction:column;
          align-items:flex-start;
          gap:.4rem;
        }
      }
      /* layout grid */
      .layout-grid{
        display:grid;
        grid-template-columns: 1fr;
        gap:1rem;
      }

/* ===== DESKTOP LAYOUT STRUCTURE ===== */

.layout-grid{
  display:grid;
  grid-template-columns: 1fr;
  gap:1.2rem;
}

.theme-control{
  margin-top: 1.2rem;
  display: flex;
  justify-content: flex-end;
}

.theme-control select{
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text-muted);
  border-radius: 8px;
  font-size: .72rem;
  padding: .2rem .3rem;
  opacity: .35;
}

.theme-control select:hover,
.theme-control select:focus-visible{
  opacity: .9;
  color: var(--text-primary);
}

/* Desktop: sidebar + content */
@media (min-width: 900px){
  .layout-grid{
    grid-template-columns: 280px minmax(0,1fr);
    align-items:start;
  }

  .content{
    min-width:0;
  }
}
    </style>
  </head>

  <body>
    <main class="container layout-grid">
      <Menu currentPath={currentPath} />
      <section class="content" role="main">
        <slot />
        <footer class="theme-control" aria-label="Theme controls">
          <select id="themePicker" aria-label="Theme picker" title="Theme (Ctrl+Shift+T)">
            <option value="rose-pine">rose pine</option>
            <option value="latte">latte</option>
            <option value="amoled">amoled</option>
          </select>
        </footer>
      </section>
    </main>
    <script is:inline>
      (() => {
        const root = document.documentElement;
        const picker = document.getElementById('themePicker');
        const themeMeta = document.querySelector('meta[name="theme-color"]');
        const themes = ['rose-pine', 'latte', 'amoled'];

        const applyTheme = (theme) => {
          const selected = themes.includes(theme) ? theme : 'rose-pine';
          if (selected === 'rose-pine') {
            root.removeAttribute('data-theme');
          } else {
            root.setAttribute('data-theme', selected);
          }
          if (picker) picker.value = selected;
          if (themeMeta) {
            const base = getComputedStyle(root).getPropertyValue('--background').trim();
            if (base) themeMeta.setAttribute('content', base);
          }
          try { localStorage.setItem('site-theme', selected); } catch (e) {}
        };

        let savedTheme = 'rose-pine';
        try { savedTheme = localStorage.getItem('site-theme') || 'rose-pine'; } catch (e) {}
        applyTheme(savedTheme);

        picker?.addEventListener('change', (event) => {
          applyTheme(event.target.value);
        });

        document.addEventListener('keydown', (event) => {
          if (!(event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 't')) return;
          event.preventDefault();
          const current = picker?.value || savedTheme;
          const next = themes[(themes.indexOf(current) + 1) % themes.length];
          applyTheme(next);
        });
      })();
    </script>
  </body>
</html>
